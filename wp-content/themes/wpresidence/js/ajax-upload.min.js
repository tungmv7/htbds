jQuery(document).ready(function(a){if(typeof(plupload)!=="undefined"){var b=new plupload.Uploader(ajax_vars.plupload);b.init();b.bind("FilesAdded",function(c,d){a.each(d,function(f,e){a("#aaiu-upload-imagelist").append('<div id="'+e.id+'">'+e.name+" ("+plupload.formatSize(e.size)+") <b></b></div>")});c.refresh();b.start()});b.bind("UploadProgress",function(c,d){a("#"+d.id+" b").html(d.percent+"%")});b.bind("Error",function(c,d){a("#aaiu-upload-imagelist").append("<div>Error: "+d.code+", Message: "+d.message+(d.file?", File: "+d.file.name:"")+"</div>");c.refresh()});b.bind("FileUploaded",function(d,g,f){console.log(f);var c=a.parseJSON(f.response);a("#image_warn").remove();a("#"+g.id).remove();if(c.success){a("#profile-image").attr("src",c.html);a("#profile-image").attr("data-profileurl",c.html);a("#profile-image").attr("data-smallprofileurl",c.attach);var e=a("#attachid").val();e=e+","+c.attach;a("#attachid").val(e);if(c.html!==""){if(ajax_vars.is_floor==="1"){a("#no_plan_mess").remove();a("#imagelist").append('<div class="uploaded_images floor_container" data-imageid="'+c.attach+'"><input type="hidden" name="plan_image_attach[]" value="'+c.attach+'"><input type="hidden" name="plan_image[]" value="'+c.html+'"><img src="'+c.html+'" alt="thumb" /><i class="fa deleter fa-trash-o"></i>'+to_insert_floor+"</div>")}else{a("#imagelist").append('<div class="uploaded_images" data-imageid="'+c.attach+'"><img src="'+c.html+'" alt="thumb" /><i class="fa deleter fa-trash-o"></i> </div>')}}else{a("#imagelist").append('<div class="uploaded_images" data-imageid="'+c.attach+'"><img src="'+ajax_vars.path+'/img/pdf.png" alt="thumb" /><i class="fa deleter fa-trash-o"></i> </div>')}a("#imagelist").sortable({revert:true,update:function(j,k){var i,h;i="";a("#imagelist .uploaded_images").each(function(){h=a(this).attr("data-imageid");if(typeof h!="undefined"){i=i+","+h}});a("#attachid").val(i)},});delete_binder();thumb_setter()}else{if(c.image){a("#imagelist,#upload-container").before('<div id="image_warn" style="width:100%;float:left;">'+ajax_vars.warning+"</div>")}}});a("#aaiu-uploader").click(function(c){c.preventDefault();c.stopPropagation();b.start()});a("#aaiu-uploader2").click(function(c){b.start();c.preventDefault()});a("#aaiu-uploader-floor").click(function(c){c.preventDefault();a("#aaiu-uploader").trigger("click")})}});function thumb_setter(){jQuery("#imagelist img").dblclick(function(){jQuery("#imagelist .uploaded_images .thumber").each(function(){jQuery(this).remove()});jQuery(this).parent().append('<i class="fa thumber fa-star"></i>');jQuery("#attachthumb").val(jQuery(this).parent().attr("data-imageid"))})}function delete_binder(){jQuery("#imagelist i.fa-trash-o").click(function(){var a="";jQuery(this).parent().remove();jQuery("#imagelist .uploaded_images").each(function(){a=a+","+jQuery(this).attr("data-imageid")});jQuery("#attachid").val(a)})}to_insert_floor='<div class=""><p class="meta-options floor_p">\n                <label for="plan_title">'+control_vars.plan_title+'</label><br />\n                <input id="plan_title" type="text" size="36" name="plan_title[]" value="" />\n            </p>\n            \n            <p class="meta-options floor_full"> \n                <label for="plan_description">'+control_vars.plan_desc+'</label><br /> \n                <textarea class="plan_description" type="text" size="36" name="plan_description[]" ></textarea> \n            </p>\n             \n            <p class="meta-options floor_p"> \n                <label for="plan_size">'+control_vars.plan_size+'</label><br /> \n                <input id="plan_size" type="text" size="36" name="plan_size[]" value="" /> \n            </p> \n            \n            <p class="meta-options floor_p"> \n                <label for="plan_rooms">'+control_vars.plan_rooms+'</label><br /> \n                <input id="plan_rooms" type="text" size="36" name="plan_rooms[]" value="" /> \n            </p> \n            <p class="meta-options floor_p"> \n                <label for="plan_bath">'+control_vars.plan_bathrooms+'</label><br /> \n                <input id="plan_bath" type="text" size="36" name="plan_bath[]" value="" /> \n            </p> \n            <p class="meta-options floor_p"> \n                <label for="plan_price">'+control_vars.plan_price+'</label><br /> \n                <input id="plan_price" type="text" size="36" name="plan_price[]" value="" /> \n            </p> \n    </div>';